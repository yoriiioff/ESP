# ESP Детектор для Видео

Этот скрипт обрабатывает видео и добавляет ESP-подобные элементы (как в играх), обводя красными квадратами и подписывая обнаруженные объекты.

## Возможности

- Обнаружение людей, светофоров, мониторов, ноутбуков, клавиатур, стульев, столов, кроватей, унитазов, машин, велосипедов, мотоциклов, автобусов, грузовиков и растений в горшках
- Красные прямоугольники вокруг объектов
- Подписи на английском языке
- Сохранение оригинального аудио в выходном видео
- Вывод в формате MP4

## Установка

1. Установите зависимости:
```bash
pip install -r requirements.txt
```

## Использование

Запустите скрипт с путем к видео файлу:
```bash
python esp_detector.py путь_к_вашему_видео.mp4
```

Обработанное видео будет сохранено как `out.mp4` в той же папке, что и исходное видео.

### Примеры:
```bash
python esp_detector.py video.mp4
python esp_detector.py "C:\Videos\my_video.avi"
python esp_detector.py ../videos/input.mov
```

## Поддерживаемые форматы видео

- MP4, AVI, MOV и другие форматы, поддерживаемые OpenCV

## Требования

- Python 3.7+
- CUDA-compatible GPU (рекомендуется для ускорения)

## Примечание

Скрипт использует модель YOLOv8 nano для обнаружения объектов из датасета COCO. Для лучшей производительности можно использовать более крупные модели (yolov8s.pt, yolov8m.pt и т.д.), но они требуют больше ресурсов.

**Ограничения модели:**
- Модель YOLOv8 COCO dataset не содержит классов для зданий, дверей, лестниц, земли или естественных деревьев
- Вместо деревьев обнаруживаются растения в горшках (potted plant)
- Светофоры обнаруживаются с пониженным порогом уверенности (0.2 вместо 0.4)
- Для обнаружения зданий или другой архитектуры потребуется другая модель или датасет

**Что обнаруживается:**
- Люди, машины всех типов, светофоры, мониторы, мебель, бытовая техника, растения в горшках
